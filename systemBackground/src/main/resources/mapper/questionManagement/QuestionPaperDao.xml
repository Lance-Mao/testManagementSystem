<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="io.renren.modules.questionManagement.dao.QuestionPaperDao">

	<!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="io.renren.modules.questionManagement.entity.QuestionPaperEntity" id="questionPaperMap">
        <result property="id" column="id"/>
        <result property="documentType" column="document_type"/>
        <result property="questionType" column="question_type"/>
        <result property="uploadAddress" column="upload_address"/>
        <result property="uploadBy" column="upload_by"/>
        <result property="uploadTime" column="upload_time"/>
    </resultMap>

    <select id="selectPage" parameterType="map" resultType="map">
        select qct.course_title courseTitle,qkp.knowledge_point knowledgePoint,qp.*,su.username
        from question_paper qp
        left join sys_user su on su.user_id = qp.upload_by
        left join question_course_title qct on qct.id = qp.course_title_id
        left join question_knowledge_point qkp on qkp.id = qp.knowledge_point_id
        <where>
            <if test='pageInfo.key != ""'>
                qct.course_title = #{pageInfo.key} or
                qkp.knowledge_point = #{pageInfo.key} or
                su.username = #{pageInfo.key}
            </if>
        </where>
        ORDER BY qp.id DESC
        LIMIT #{pageInfo.page},#{pageInfo.limit}
    </select>

    <select id="selectTotalCount" parameterType="map" resultType="int">
        select COUNT(1) from question_paper qp
        left join sys_user su on su.user_id = qp.upload_by
        left join question_course_title qct on qct.id = qp.course_title_id
        left join question_knowledge_point qkp on qkp.id = qp.knowledge_point_id
        <where>
            <if test='pageInfo.key != ""'>
                qct.course_title = #{pageInfo.key} or
                qkp.knowledge_point = #{pageInfo.key} or
                su.username = #{pageInfo.key}
            </if>
        </where>
    </select>

</mapper>